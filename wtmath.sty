%
% wtmath.sty
%

%%%% package declaration
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{wtmath}[2016/08/11 dev]
\def\wtmt@pkgname{WTMath}
\RequirePackage{xkeyval,amsmath}

%%%% error messages
\def\wtmt@warn{\PackageWarningNoLine\wtmt@pkgname}
\def\wtmt@error{\PackageError\wtmt@pkgname}

%%%% new dimen
\newdimen\wtmt@tempdima

%%%% utility
\def\wtmt@get@capital@height#1{% #1:dimen
  \begingroup\sbox\z@ A\global#1\ht\z@\endgroup}
\def\wtmt@print@right#1{\relax\ifmmode\eqno{#1}\else\hfill#1\fi}

%%%% use library
\def\usemathlibrary#1{\input{lib/wtmath-#1.def}}

%%%% for setting
\newcommand{\relmiddle}[1]{\mathrel{}\middle#1\mathrel{}}
\newcommand{\mathbold}[1]{\text{\boldmath$#1$}}
\newcommand{\exchangecmd}[2]{\let\wtmt@temp#1\let#1#2\let#2\wtmt@temp}

%%%% basic commands
\newcommand{\func}[1]{\mathrm{#1}}
\newcommand{\eqsep}{\;}
\newcommand{\then}{\Rightarrow}
\newcommand{\st}{\text{\space such that\space}}
\newcommand{\tand}{\text{\space and\space}}
\newcommand{\tor}{\text{\space or\space}}
\newcommand{\defeq}{:=}
\newcommand{\defiff}{\overset{\mathrm{def}}{\iff}}
\newcommand{\qed}{\wtmt@print@right\wtmt@halmos}

%%%% patch to amsmath
\renewcommand{\bar}[1]{%
  \begingroup
    \wtmt@get@capital@height\wtmt@tempdima
    \overline{#1\rule{0pt}{\wtmt@tempdima}}%
  \endgroup}

%%%% symbols
\def\wtmt@halmos{%
  \begingroup
    \wtmt@get@capital@height\wtmt@tempdima
    \rule[-.15\wtmt@tempdima]{.6\wtmt@tempdima}{1.2\wtmt@tempdima}%
  \endgroup}

%% EOF
